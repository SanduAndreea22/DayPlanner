{% extends "base.html" %}

{% block title %}ğŸŒ¿ Ziua mea Â· Emotional Planner{% endblock %}

{% block content %}
<div class="card day-card">

    <!-- ğŸ“… DATA -->
    <div class="day-date title-gradient">
        {{ day.date|date:"l, d F Y" }}
    </div>

    <!-- ğŸŒ± MESAJ BLÃ‚ND -->
    {% if message %}
        <div class="message">
            {{ message }}
        </div>
    {% endif %}

    <!-- ğŸ¨ ENERGIA ZILEI -->
    <form method="post" action="{% url 'set_day_color' %}" class="day-section">
        {% csrf_token %}
        <input type="hidden" name="day_id" value="{{ day.id }}">

        <label>ğŸ¨ Energia zilei</label>
        <select name="color" onchange="this.form.submit()">
            <option value="">â€”</option>
            <option value="green" {% if day.color == "green" %}selected{% endif %}>ğŸŸ¢ Verde</option>
            <option value="yellow" {% if day.color == "yellow" %}selected{% endif %}>ğŸŸ¡ Galben</option>
            <option value="red" {% if day.color == "red" %}selected{% endif %}>ğŸ”´ RoÈ™u</option>
            <option value="blue" {% if day.color == "blue" %}selected{% endif %}>ğŸ”µ Albastru</option>
            <option value="purple" {% if day.color == "purple" %}selected{% endif %}>ğŸŸ£ Mov</option>
        </select>
    </form>

    <!-- ğŸ’­ STAREA ZILEI -->
    <form method="post" action="{% url 'set_day_mood' %}" class="day-section">
        {% csrf_token %}
        <input type="hidden" name="day_id" value="{{ day.id }}">

        <label>ğŸ’­ Cum mÄƒ simt azi</label>
        <select name="mood" onchange="this.form.submit()">
            <option value="">â€”</option>
            <option value="very_bad" {% if day.mood == "very_bad" %}selected{% endif %}>ğŸ˜ Foarte greu</option>
            <option value="bad" {% if day.mood == "bad" %}selected{% endif %}>ğŸ˜• Greu</option>
            <option value="neutral" {% if day.mood == "neutral" %}selected{% endif %}>ğŸ˜ Neutru</option>
            <option value="good" {% if day.mood == "good" %}selected{% endif %}>ğŸ™‚ Bine</option>
            <option value="very_good" {% if day.mood == "very_good" %}selected{% endif %}>ğŸ˜„ Foarte bine</option>
        </select>
    </form>

    <!-- âœ¨ JURNAL ZI (CORECT) -->
    <form method="post" action="{% url 'update_day_text' %}" class="day-section">
        {% csrf_token %}
        <input type="hidden" name="day_id" value="{{ day.id }}">

        <label>âœ¨ Un gÃ¢nd important azi</label>
        <textarea
            name="text"
            rows="4"
            placeholder="Ce e important pentru tine azi, ce simÈ›i, ce vrei sÄƒ È›ii minte..."
        >{{ day.text }}</textarea>

        <button type="submit" class="button primary day-save">
            SalveazÄƒ
        </button>
    </form>

    <!-- â• ADAUGÄ‚ INTERVAL -->
    <div class="day-section">
        <h3>â• Interval nou</h3>

        <form method="post" action="{% url 'add_timeblock' %}">
            {% csrf_token %}
            <input type="hidden" name="day_id" value="{{ day.id }}">

            <div class="time-row">
                <input type="time" name="start_time" required>
                <span>â€“</span>
                <input type="time" name="end_time" required>
            </div>

            <input type="text" name="title" placeholder="Ce faci" required>

            <button type="submit" class="button">
                AdaugÄƒ
            </button>
        </form>
    </div>

    <!-- â° ORAR -->
    <div class="day-section">
        <h3>â° Orarul zilei</h3>

        {% if time_blocks %}
            {% for block in time_blocks %}
                <div class="time-block">
                    <div class="time">
                        {{ block.start_time|time:"H:i" }} â€“ {{ block.end_time|time:"H:i" }}
                    </div>

                    <div class="block-title {% if block.completed %}completed{% endif %}">
                        {{ block.title }}
                    </div>

                    <div class="actions">
                        <a href="{% url 'toggle_timeblock' block.id %}">
                            {% if block.completed %}âœ…{% else %}â¬œ{% endif %}
                        </a>
                        <a href="{% url 'delete_timeblock' block.id %}">
                            âŒ
                        </a>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <p class="muted">Nu ai adÄƒugat Ã®ncÄƒ nimic azi.</p>
        {% endif %}
    </div>

    <!-- ğŸŒ™ REFLECÈšIE DE SEARÄ‚ -->
    <div class="day-evening">
        <a href="{% url 'evening_reflection' %}" class="button primary">
            ğŸŒ™ Ãnchide ziua cu blÃ¢ndeÈ›e
        </a>
    </div>

    <!-- ğŸ”™ -->
    <div class="day-back">
        <a href="{% url 'calendar' %}" class="muted">
            â† Ãnapoi la calendar
        </a>
    </div>

</div>
{% endblock %}




